<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:composite="http://xmlns.jcp.org/jsf/composite/composite"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
   <h:head>
      <title>Facelet Title</title>
   </h:head>
   <h:body>
      <ui:composition template="/template/layout.xhtml">
         <ui:define name="content">
            Cadastro de Contatos

            <h:form id="frmBtnComposites" class="item pull-right">

               <div class="item">
                  <p:commandLink action="#{contactMB.newAddress}"
                                 class="link"
                                 oncomplete="$('#modalAddress').modal('show');"
                                 update=":cmpAddress:frmAddAddress">
                     <span class="icon-home icon-label"></span>
                     Adicionar Endereço
                  </p:commandLink>
               </div>

               <div class="item">
                  <p:commandLink action="#{contactMB.newPhone}"
                                 class="link"
                                 oncomplete="$('#modalPhone').modal('show');"
                                 update=":cmpPhone:frmAddPhone">
                     <span class="icon-phone icon-label"></span>
                     Adicionar Contato
                  </p:commandLink>
               </div>  

               <div class="item">
                  <p:commandLink action="#{contactMB.newEmail}"
                                 class="link"
                                 oncomplete="$('#modalEmail').modal('show');"
                                 update=":cmpEmail:frmAddEmail">
                     <span class="icon-at icon-label"></span>
                     Adicionar E-mail
                  </p:commandLink>
               </div>

            </h:form>

            <div class="row">
               <!--    ////////////////////////////// LISTAGEM DOS CONTATOS TELEFONICOS  //////////////////////////   -->
               <div class="col-sm-3">

                  <h:panelGrid id="pnlPhones">
                     <h:dataTable id="tblPhones"
                                  class="table table-bordered table-striped table-hover"
                                  var="phone" 
                                  value="#{contactMB.listPhones}"
                                  rendered="#{!empty contactMB.listPhones}">  
                        <h:inputHidden value="#{phone.id}"></h:inputHidden>

                        <f:facet name="header">
                           Contatos Telefônicos
                        </f:facet>

                        <h:column>
                           <h:outputText value="#{phone.tipo}"></h:outputText>
                        </h:column>

                        <h:column>
                           <h:outputText value="(#{phone.codArea}) #{phone.numero}"></h:outputText>
                        </h:column>

                        <h:column>
                           <p:commandLink id="btnEditPhone" 
                                          update=":cmpPhone:frmAddPhone"
                                          oncomplete="$('#modalPhone').modal('show');"
                                          title="Editar"
                                          immediate="true">
                              <span class="icon-edit"></span>
                              <f:setPropertyActionListener target="#{contactMB.phone}" value="#{phone}"/>
                           </p:commandLink>
                        </h:column>

                        <h:column>
                           <h:commandLink title="Excluir" 
                                          action="#{contactMB.removePhone}">
                              <f:ajax execute="@this" render=":frmCadastro:pnlPhones"/>
                              <span class="icon-minus-square"></span>
                              <f:setPropertyActionListener target="#{contactMB.phone}" value="#{phone}"/>
                           </h:commandLink>
                        </h:column>

                     </h:dataTable>
                  </h:panelGrid>

               </div>
               <!--    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////   -->
               <!--    /////////////////////////////////// LISTAGEM DOS ENDERECOS ADICIONADOS //////////////////////////   -->
               <div class="col-sm-3">
                  <h:panelGrid id="pnlAddress">
                     <h:dataTable id="tblAddress"
                                  class="table table-bordered table-striped table-hover"
                                  var="address" 
                                  value="#{contactMB.address}"
                                  rendered="#{!empty contactMB.address}"> 
                        <h:inputHidden value="#{address.id}"/>
                        <f:facet name="header">
                           Endereço
                        </f:facet>
                        <h:column>
                           <h:outputText value="#{address.tipoAddress}"/>
                        </h:column>
                        <h:column>
                           <h:outputText value="#{address.logradouro}, Nº #{address.numero} "/>
                        </h:column>
                        <h:column>
                           <p:commandLink immediate="true"
                                          oncomplete="$('#modalAddress').modal('show');"
                                          update=":cmpAddress:frmAddAddress">
                              <span class="icon-edit"></span>
                              <f:setPropertyActionListener target="#{contactMB.address}" value="#{address}"/>
                           </p:commandLink>
                        </h:column>
                        <h:column>
                           <h:commandLink title="Excluir" 
                                          action="#{contactMB.removeAddress}">
                              <f:ajax execute="@this" render=":frmCadastro:pnlAddress"/>
                              <span class="icon-minus-square"></span>
                              <f:setPropertyActionListener target="#{contactMB.address}" value="#{address}"/>
                           </h:commandLink>
                        </h:column>
                     </h:dataTable>
                  </h:panelGrid>
               </div>
               <!--    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////   -->
               <!--    ////////////////////////////// LISTAGEM DOS EMAILS ADICIONADOS //////////////////////////   -->
               <div class="col-sm-3">
                  <h:panelGrid id="pnlEmails">
                     <h:dataTable id="tblEmails"
                                  class="table table-bordered table-striped table-hover"
                                  var="email" 
                                  value="#{contactMB.emails}"
                                  rendered="#{!empty contactMB.emails}">  
                        <h:inputHidden value="#{email.id}"/>
                        <f:facet name="header">
                           E-mail
                        </f:facet>
                        <h:column>
                           <h:outputText value="#{email.tipo}"/>
                        </h:column>
                        <h:column>
                           <h:outputText value="#{email.email}"/>
                        </h:column>
                        <h:column>
                           <p:commandLink immediate="true"
                                          oncomplete="$('#modalEmail').modal('show');" 
                                          title="Editar" 
                                          update=":cmpEmail:frmAddEmail">
                              <span class="icon-edit"></span>
                              <f:setPropertyActionListener target="#{contactMB.email}" value="#{email}" />
                           </p:commandLink>
                        </h:column>
                        <h:column>
                           <h:commandLink title="Excluir" 
                                          action="#{contactMB.removeEmail}">
                              <f:ajax execute="@this" render=":frmCadastro:pnlEmails"/>
                              <span class="icon-minus-square"></span>
                              <f:setPropertyActionListener target="#{contactMB.email}" value="#{email}"/>
                           </h:commandLink>
                        </h:column>
                     </h:dataTable>
                  </h:panelGrid>
               </div>
               <!--    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////   -->
            </div>

            <composite:phone id="cmpPhone"
                             code="#{contactMB.phone.id}"
                             type="#{contactMB.phone.tipo}"
                             codArea="#{contactMB.phone.codArea}"
                             number="#{contactMB.phone.numero}"
                             observation="#{contactMB.phone.observacao}"
                             btnAddText="Adicionar"
                             btnAddAction="#{contactMB.addPhone}">
            </composite:phone>

            <composite:address id="cmpAddress"
                               code="#{contactMB.address.id}"
                               typeAddress="#{contactMB.address.typeAddress}" 
                               typeStreet="#{contactMB.address.typeStreet}"
                               street="#{contactMB.address.street}"
                               number="#{contactMB.address.number}" 
                               neighbourhood="#{contactMB.address.neighbourhood}"
                               zipCode="#{contactMB.address.zipCode}"
                               state="#{contactMB.address.state}"
                               city="#{contactMB.address.city}"
                               btnAddText="Adicionar"
                               btnAddAction="#{contactMB.addAddress}">
            </composite:address> 

            <composite:email id="cmpEmail"
                             code="#{contactMB.email.id}"
                             type="#{contactMB.email.type}"
                             email="#{contactMB.email.email}"
                             btnAddText="Adicionar"
                             btnAddAction="#{contactMB.addEmail}">
            </composite:email>

         </ui:define>
      </ui:composition>

   </h:body>
</html>

